<style>
body {
background-color: #222;
color: #fff;
        counter-reset: h1counter;
        counter-reset: h2counter;
}
    h1:before {
        content: counter(h1counter) ".\0000a0\0000a0";
    }
    h1 {
        counter-reset: h2counter;
        counter-increment: h1counter;
    }
    h2:before {
        content: counter(h1counter) "." counter(h2counter) ".\0000a0\0000a0";
        counter-increment: h2counter;
    }
</style>

<h1>repo: https://github.com/dashevo/dapi</h1>

<h2>npm audit --only=prod</h2>
<pre><b># npm audit report</b>

<b>ansi-regex</b>  &gt;2.1.1 &lt;5.0.1
Severity: <font color="#A2734C"><b>moderate</b></font>
<b> Inefficient Regular Expression Complexity in chalk/ansi-regex</b> - https://github.com/advisories/GHSA-93q8-gq69-wqmw
<font color="#A2734C"><b>fix available</b></font> via `npm audit fix --force`
Will install eslint@8.1.0, which is a breaking change
<font color="#AAAAAA">node_modules/eslint/node_modules/ansi-regex</font>
<font color="#AAAAAA">node_modules/inquirer/node_modules/ansi-regex</font>
<font color="#AAAAAA">node_modules/inquirer/node_modules/strip-ansi/node_modules/ansi-regex</font>
<font color="#AAAAAA">node_modules/table/node_modules/ansi-regex</font>
  <b>strip-ansi</b>  4.0.0 - 5.2.0
  Depends on vulnerable versions of <b>ansi-regex</b>
  node_modules/eslint/node_modules/strip-ansi
  node_modules/inquirer/node_modules/string-width/node_modules/strip-ansi
  node_modules/inquirer/node_modules/strip-ansi
  node_modules/table/node_modules/strip-ansi
    <b>eslint</b>  4.5.0 - 7.15.0
    Depends on vulnerable versions of <b>inquirer</b>
    Depends on vulnerable versions of <b>strip-ansi</b>
    Depends on vulnerable versions of <b>table</b>
    node_modules/eslint
    <b>inquirer</b>  3.2.0 - 7.0.4
    Depends on vulnerable versions of <b>string-width</b>
    Depends on vulnerable versions of <b>strip-ansi</b>
    node_modules/inquirer
    <b>string-width</b>  2.1.0 - 4.1.0
    Depends on vulnerable versions of <b>strip-ansi</b>
    node_modules/inquirer/node_modules/string-width
    node_modules/table/node_modules/string-width
      <b>table</b>  4.0.2 - 5.4.6
      Depends on vulnerable versions of <b>string-width</b>
      node_modules/table

<b>elliptic</b>  &lt;6.5.4
Severity: <font color="#A2734C"><b>moderate</b></font>
<b>Use of a Broken or Risky Cryptographic Algorithm</b> - https://github.com/advisories/GHSA-r9p9-mrjm-926w
<font color="#A2734C"><b>fix available</b></font> via `npm audit fix --force`
Will install @dashevo/dashcore-lib@0.18.15, which is a breaking change
<font color="#AAAAAA">node_modules/elliptic</font>
  <b>@dashevo/dashcore-lib</b>  &lt;=0.18.11 || &gt;=0.19.0
  Depends on vulnerable versions of <b>elliptic</b>
  node_modules/@dashevo/dashcore-lib
    <b>@dashevo/dpp</b>  &lt;=0.10.1 || 0.15.0-dev.3 - 0.15.0-dev.14 || &gt;=0.17.0-dev.2
    Depends on vulnerable versions of <b>@dashevo/dashcore-lib</b>
    node_modules/@dashevo/dpp

9 <font color="#A2734C"><b>moderate</b></font> severity vulnerabilities
</pre>

<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre><font color="#26A269">lib/config/index.js</font>
<font color="#C01C28">severity:error </font><font color="#A2734C">rule:ajinabraham.njsscan.hardcoded_secrets.node_password: A hardcoded password in plain text is identified. Store it properly in an environment variable.</font>
<font color="#26A269">30</font>:<font color="#5E5C64">DEFAULT_CONFIG[OPTIONS.DASHCORE_RPC_PASS] = &apos;password&apos;;</font>
--------------------------------------------------------------------------------
<font color="#C01C28">severity:error </font><font color="#A2734C">rule:ajinabraham.njsscan.hardcoded_secrets.node_username: A hardcoded username in plain text is identified. Store it properly in an environment variable.</font>
<font color="#26A269">29</font>:<font color="#5E5C64">DEFAULT_CONFIG[OPTIONS.DASHCORE_RPC_USER] = &apos;dashrpc&apos;;</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via optionName</font>
<font color="#26A269">48</font>:      <font color="#5E5C64">envConfig[optionName] = process.env[optionName];</font>

<font color="#26A269">lib/grpcServer/handlers/core/getStatusHandlerFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via masternodeStatusResponse.state</font>
<font color="#26A269">53</font>:    <font color="#5E5C64">const masternodeStatus = GetStatusResponse.Masternode.Status[masternodeStatusResponse.state];</font>

<font color="#26A269">lib/grpcServer/handlers/createGrpcErrorFromDriveResponse.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via code.toString()</font>
<font color="#26A269">64</font>:    <font color="#5E5C64">const CommonErrorClass = COMMON_ERROR_CLASSES[code.toString()];</font>

<font color="#26A269">lib/log/Logger.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.error_disclosure.generic_error_disclosure: Error messages with stack traces may expose sensitive information about the application.</font>
<font color="#26A269">53</font>:        <font color="#5E5C64">try {</font>
<font color="#26A269">54</font>:<font color="#5E5C64">          appendFileAsync(this.outputFilePath, EOL + log.trim(), { encoding: &apos;utf8&apos; });</font>
<font color="#26A269">55</font>:<font color="#5E5C64">        } catch (error) {</font>
<font color="#26A269">56</font>:<font color="#5E5C64">          // eslint-disable-next-line no-console</font>
<font color="#26A269">57</font>:<font color="#5E5C64">          console.error(`Error: Logger: ${error}`);</font>
<font color="#26A269">58</font>:<font color="#5E5C64">        }</font>

<font color="#26A269">lib/transactionsFilter/TransactionHashesCache.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">166</font>:      <font color="#5E5C64">const { transaction } = this.transactions[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">174</font>:      <font color="#5E5C64">const { merkleBlock } = this.merkleBlocks[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">183</font>:      <font color="#5E5C64">const cachedBlock = this.blocks[i];</font>

<font color="#26A269">test/functional/grpcServer/handlers/tx-filter-stream/subscribeToTransactionsWithProofsHandlerFactory.spec.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via receivedTransactions.length - 1</font>
<font color="#26A269">514</font>:    <font color="#5E5C64">const lastReceivedTransaction = receivedTransactions[receivedTransactions.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via historicalTransactions.length - 1</font>
<font color="#26A269">515</font>:    <font color="#5E5C64">const lastHistoricalTransaction = historicalTransactions[historicalTransactions.length - 1];</font>
ran 162 rules on 134 files: 11 findings
</pre>

<hr>

<h1>repo: https://github.com/dashevo/dashd-rpc</h1>

<h2>npm audit --only=prod</h2>
<pre>found <font color="#26A269"><b>0</b></font> vulnerabilities</pre>

<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre><font color="#26A269">lib/index.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.crypto_node.node_insecure_random_generator: crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.</font>
<font color="#26A269">366</font>:  return parseInt(<font color="#5E5C64">Math.random() </font>* 100000);
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via RpcClient.config.logger || &apos;normal&apos;</font>
<font color="#26A269">24</font>:    <font color="#5E5C64">this.log = RpcClient.loggers[RpcClient.config.logger || &apos;normal&apos;];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via k</font>
<font color="#26A269">81</font>:      <font color="#5E5C64">options[k] = self.httpOptions[k];</font>
--------------------------------------------------------------------------------
<font color="#26A269">359</font>:    <font color="#5E5C64">constructor.prototype[methodName] = constructor.prototype[k];</font>
ran 162 rules on 11 files: 4 findings
</pre>

<hr>

<h1>repo: https://github.com/dashevo/js-grpc-common</h1>

<h2>npm audit --only=prod</h2>
<pre>found <font color="#26A269"><b>0</b></font> vulnerabilities</pre>

<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre>ran 162 rules on 56 files: 0 findings</pre>

<hr>

<h1>repo: https://github.com/dashevo/dapi-grpc</h1>

<h2>npm audit --only=prod</h2>
<pre>found <font color="#26A269"><b>0</b></font> vulnerabilities</pre>

<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre><font color="#26A269">clients/core/v0/nodejs/core_pbjs.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">343</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">510</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">871</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1103</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1358</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1715</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2066</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2276</font>:                                            <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2494</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2726</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2924</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">3163</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">3350</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">3542</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">3855</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">4113</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">4358</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">4500</font>:                                        <font color="#5E5C64">message.headers[i] = object.headers[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">4564</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">4706</font>:                                        <font color="#5E5C64">message.messages[i] = object.messages[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">4769</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">4956</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5147</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5455</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5717</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5992</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">6134</font>:                                        <font color="#5E5C64">message.transactions[i] = object.transactions[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">6198</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">6340</font>:                                        <font color="#5E5C64">message.messages[i] = object.messages[i];</font>

<font color="#26A269">clients/platform/v0/nodejs/platform_pbjs.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">380</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">670</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">954</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1179</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1418</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1613</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1775</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1995</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2245</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2465</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">2721</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">3111</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">3289</font>:                                        <font color="#5E5C64">message.documents[i] = object.documents[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">3372</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">3530</font>:                                        <font color="#5E5C64">message.publicKeyHashes[i] = object.publicKeyHashes[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">3602</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">3780</font>:                                        <font color="#5E5C64">message.identities[i] = object.identities[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">3863</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">4021</font>:                                        <font color="#5E5C64">message.publicKeyHashes[i] = object.publicKeyHashes[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">4093</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">4271</font>:                                        <font color="#5E5C64">message.identityIds[i] = object.identityIds[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via keys[i]</font>
<font color="#26A269">4353</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">4573</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">4846</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5078</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5309</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
--------------------------------------------------------------------------------
<font color="#26A269">5533</font>:                                        <font color="#5E5C64">this[keys[i]] = properties[keys[i]];</font>
ran 162 rules on 57 files: 56 findings
</pre>

<hr>

<h1>repo: https://github.com/dashevo/dashcore-lib</h1>

<h2>npm audit --only=prod</h2>

<pre><b># npm audit report</b>

<b>elliptic</b>  &lt;6.5.4
Severity: <font color="#A2734C"><b>moderate</b></font>
<b>Use of a Broken or Risky Cryptographic Algorithm</b> - https://github.com/advisories/GHSA-r9p9-mrjm-926w
<font color="#A2734C"><b>fix available</b></font> via `npm audit fix --force`
Will install elliptic@6.5.4, which is outside the stated dependency range
<font color="#AAAAAA">node_modules/elliptic</font>

1 <font color="#A2734C"><b>moderate</b></font> severity vulnerability
</pre>


<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre><font color="#26A269">benchmark/script.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">23</font>:        <font color="#5E5C64">var tx = block.transactions[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via j</font>
<font color="#26A269">25</font>:          <font color="#5E5C64">var input = tx.inputs[j];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via k</font>
<font color="#26A269">31</font>:          <font color="#5E5C64">var output = tx.outputs[k];</font>

<font color="#26A269">benchmark/serialization.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.crypto_node.node_insecure_random_generator: crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.</font>
<font color="#26A269">28</font>:        var num = Math.round(<font color="#5E5C64">Math.random() </font>* 10000000000000);

<font color="#26A269">lib/block/merkleblock.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via options.hashesUsed++</font>
<font color="#26A269">219</font>:    <font color="#5E5C64">const hash = this.hashes[options.hashesUsed++];</font>

<font color="#26A269">lib/crypto/bn.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via buf.length - 1 - i</font>
<font color="#26A269">16</font>:    <font color="#5E5C64">buf2[i] = buf[buf.length - 1 - i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">205</font>:    <font color="#5E5C64">rbuf[rbuf.length - 1 - i] = buf[buf.length - 1 - i];</font>

<font color="#26A269">lib/crypto/hash.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.crypto_node.node_sha1: SHA1 is a a weak hash which is known to have collision. Use a strong hashing function.</font>
<font color="#26A269">15</font>:  return <font color="#5E5C64">crypto.createHash(&apos;sha1&apos;).</font>update(buf).digest();

<font color="#26A269">lib/crypto/random.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.crypto_node.node_insecure_random_generator: crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.</font>
<font color="#26A269">47</font>:      r = <font color="#5E5C64">Math.random() </font>* b32;

<font color="#26A269">lib/crypto/signature.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via 2 + 0</font>
<font color="#26A269">125</font>:  <font color="#5E5C64">var rheader = buf[2 + 0];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via 2 + 1</font>
<font color="#26A269">131</font>:  <font color="#5E5C64">var rlength = buf[2 + 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via 2 + 2 + rlength + 0</font>
<font color="#26A269">137</font>:  <font color="#5E5C64">var sheader = buf[2 + 2 + rlength + 0];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via 2 + 2 + rlength + 1</font>
<font color="#26A269">143</font>:  <font color="#5E5C64">var slength = buf[2 + 2 + rlength + 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via 5 + nLenR</font>
<font color="#26A269">260</font>:  <font color="#5E5C64">var nLenS = buf[5 + nLenR];</font>

<font color="#26A269">lib/encoding/bufferreader.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.buf.length - 1 - i</font>
<font color="#26A269">253</font>:    <font color="#5E5C64">buf[i] = this.buf[this.buf.length - 1 - i];</font>

<font color="#26A269">lib/hdprivatekey.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via name</font>
<font color="#26A269">832</font>:    <font color="#5E5C64">var buff = arg[name];</font>

<font color="#26A269">lib/hdpublickey.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via name</font>
<font color="#26A269">557</font>:    <font color="#5E5C64">var buff = arg[name];</font>

<font color="#26A269">lib/networks.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via arg</font>
<font color="#26A269">51</font>:  <font color="#5E5C64">var network = networkMaps[arg];</font>

<font color="#26A269">lib/opcode.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via arg</font>
<font color="#26A269">36</font>:    <font color="#5E5C64">value = Opcode.map[arg];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via str</font>
<font color="#26A269">82</font>:  <font color="#5E5C64">var value = Opcode.map[str];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.num</font>
<font color="#26A269">122</font>:  <font color="#5E5C64">var str = Opcode.reverseMap[this.num];</font>

<font color="#26A269">lib/script/interpreter.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">112</font>:  <font color="#5E5C64">var buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via stackCopy.length - 1</font>
<font color="#26A269">136</font>:    <font color="#5E5C64">var redeemScriptSerialized = stackCopy[stackCopy.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.pc</font>
<font color="#26A269">511</font>:  <font color="#5E5C64">var chunk = this.script.chunks[this.pc];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">772</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">832</font>:          <font color="#5E5C64">buf1 = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">833</font>:          <font color="#5E5C64">buf2 = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 3</font>
<font color="#26A269">846</font>:          <font color="#5E5C64">buf1 = this.stack[this.stack.length - 3];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">847</font>:          <font color="#5E5C64">buf2 = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">848</font>:          <font color="#5E5C64">var buf3 = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 4</font>
<font color="#26A269">862</font>:          <font color="#5E5C64">buf1 = this.stack[this.stack.length - 4];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 3</font>
<font color="#26A269">863</font>:          <font color="#5E5C64">buf2 = this.stack[this.stack.length - 3];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">902</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#26A269">971</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - n - 1</font>
<font color="#26A269">979</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - n - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 3</font>
<font color="#26A269">996</font>:          <font color="#5E5C64">x1 = this.stack[this.stack.length - 3];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">997</font>:          <font color="#5E5C64">x2 = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">998</font>:          <font color="#5E5C64">var x3 = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">1012</font>:          <font color="#5E5C64">x1 = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">1013</font>:          <font color="#5E5C64">x2 = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">1058</font>:          <font color="#5E5C64">buf1 = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">1059</font>:          <font color="#5E5C64">buf2 = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1090</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1264</font>:          <font color="#5E5C64">buf = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 2</font>
<font color="#26A269">1300</font>:          <font color="#5E5C64">bufSig = this.stack[this.stack.length - 2];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - 1</font>
<font color="#26A269">1301</font>:          <font color="#5E5C64">bufPubkey = this.stack[this.stack.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - isig - k</font>
<font color="#26A269">1404</font>:            <font color="#5E5C64">bufSig = this.stack[this.stack.length - isig - k];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - isig</font>
<font color="#26A269">1411</font>:            <font color="#5E5C64">bufSig = this.stack[this.stack.length - isig];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.stack.length - ikey</font>
<font color="#26A269">1413</font>:            <font color="#5E5C64">bufPubkey = this.stack[this.stack.length - ikey];</font>

<font color="#26A269">lib/script/script.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">114</font>:    <font color="#5E5C64">var chunk = this.chunks[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">272</font>:    <font color="#5E5C64">var chunk = this.chunks[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">282</font>:    <font color="#5E5C64">var chunk = this.chunks[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this.chunks.length - 1</font>
<font color="#26A269">426</font>:  <font color="#5E5C64">var redeemChunk = this.chunks[this.chunks.length - 1];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">757</font>:    <font color="#5E5C64">var publicKey = sorted[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1090</font>:  <font color="#5E5C64">var chunk = this.chunks[i];</font>

<font color="#26A269">lib/transaction/payload/payload.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via payloadType</font>
<font color="#26A269">48</font>:  <font color="#5E5C64">var GenericPayload = PayloadClasses[payloadType];</font>

<font color="#26A269">lib/transaction/transaction.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via index</font>
<font color="#26A269">325</font>:    <font color="#5E5C64">output = this.outputs[index];</font>
--------------------------------------------------------------------------------
<font color="#26A269">1083</font>:  <font color="#5E5C64">var output = this.outputs[index];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via this._changeIndex</font>
<font color="#26A269">1170</font>:    <font color="#5E5C64">var changeOutput = this.outputs[this._changeIndex];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via index</font>
<font color="#26A269">1193</font>:  <font color="#5E5C64">var input = this.inputs[index];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">1335</font>:    <font color="#5E5C64">var txout = this.outputs[i];</font>

<font color="#26A269">lib/uri.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via key</font>
<font color="#26A269">158</font>:    <font color="#5E5C64">destination[key] = obj[key];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">184</font>:    <font color="#5E5C64">var m = URI.Members[i];</font>

<font color="#26A269">lib/util/buffer.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via param.length - i - 1</font>
<font color="#26A269">159</font>:      <font color="#5E5C64">ret[i] = param[param.length - i - 1];</font>

<font color="#26A269">lib/util/hashutil.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.crypto_node.node_insecure_random_generator: crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.</font>
<font color="#26A269">8</font>:    return Hash.sha256sha256(Buffer.from(<font color="#5E5C64">Math.random().</font>toString())).toString(

<font color="#26A269">test/govobject/govobject.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via index</font>
<font color="#26A269">389</font>:    <font color="#5E5C64">var nextSource = arguments[index];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via nextKey</font>
<font color="#26A269">396</font>:          <font color="#5E5C64">to[nextKey] = nextSource[nextKey];</font>

<font color="#26A269">test/mnemonic/mnemonic.unit.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via key</font>
<font color="#26A269">206</font>:        <font color="#5E5C64">vector_wordlists[key.toLowerCase()] = Mnemonic.Words[key];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via lang</font>
<font color="#26A269">212</font>:        <font color="#5E5C64">var wordlist = vector_wordlists[lang];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via v</font>
<font color="#26A269">213</font>:        <font color="#5E5C64">var vector = bip39_vectors[lang][v];</font>

<font color="#26A269">test/opcode.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">129</font>:      <font color="#5E5C64">var op = smallints[i];</font>
--------------------------------------------------------------------------------
<font color="#26A269">150</font>:      <font color="#5E5C64">var op = smallints[i];</font>

<font color="#26A269">test/script/interpreter.js</font>
<font color="#A2734C">severity:warning rule:ajinabraham.njsscan.timing_attack_node.node_timing_attack: String comparisons using &apos;===&apos;, &apos;!==&apos;, &apos;!=&apos; and &apos;==&apos; is vulnerable to timing attacks. More info: https://snyk.io/blog/node-js-timing-attack-ccc-ctf/</font>
<font color="#26A269">28</font>:    <font color="#5E5C64">if (token === &apos;&apos;) {</font>
<font color="#26A269">29</font>:<font color="#5E5C64">      continue;</font>
<font color="#26A269">30</font>:<font color="#5E5C64">    }</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">27</font>:    <font color="#5E5C64">var token = tokens[i];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via txidhex + &apos;:&apos; + txoutnum</font>
<font color="#26A269">341</font>:              <font color="#5E5C64">var scriptPubkey = map[txidhex + &apos;:&apos; + txoutnum];</font>

<font color="#26A269">test/transaction/transaction.js</font>
<font color="#C01C28">severity:error </font><font color="#A2734C">rule:ajinabraham.njsscan.hardcoded_secrets.node_username: A hardcoded username in plain text is identified. Store it properly in an environment variable.</font>
<font color="#26A269">1646</font>:    var <font color="#5E5C64">username = &apos;test&apos;;</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i + 1</font>
<font color="#26A269">254</font>:          <font color="#5E5C64">var args = vector[i + 1];</font>
ran 162 rules on 317 files: 77 findings
</pre>



<hr>

<h1>repo: https://github.com/dashevo/js-dpp</h1>

<h2>npm audit --only=prod</h2>
<pre><b># npm audit report</b>

<b>elliptic</b>  &lt;6.5.4
Severity: <font color="#A2734C"><b>moderate</b></font>
<b>Use of a Broken or Risky Cryptographic Algorithm</b> - https://github.com/advisories/GHSA-r9p9-mrjm-926w
<font color="#A2734C"><b>fix available</b></font> via `npm audit fix --force`
Will install @dashevo/dashcore-lib@0.18.15, which is a breaking change
<font color="#AAAAAA">node_modules/@dashevo/dashcore-lib/node_modules/elliptic</font>
  <b>@dashevo/dashcore-lib</b>  &lt;=0.18.11 || &gt;=0.19.0
  Depends on vulnerable versions of <b>elliptic</b>
  node_modules/@dashevo/dashcore-lib

2 <font color="#A2734C"><b>moderate</b></font> severity vulnerabilities</pre>

<h2>semgrep --config "p/nodejsscan" --config "p/nodejs"</h2>
<pre><font color="#26A269">lib/dataContract/enrichDataContractWithBaseSchema.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via type</font>
<font color="#26A269">28</font>:    <font color="#5E5C64">const clonedDocument = clonedDocuments[type];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via name</font>
<font color="#26A269">41</font>:        <font color="#5E5C64">clonedDocument.properties[name] = baseProperties[name];</font>

<font color="#26A269">lib/dataContract/getBinaryPropertiesFromSchema.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via name</font>
<font color="#26A269">22</font>:    <font color="#5E5C64">const property = schema.properties[name];</font>
--------------------------------------------------------------------------------
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.prototype-pollution.prototype-pollution-function.prototype-pollution-function: Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</font>
<font color="#26A269">71</font>:        <font color="#5E5C64">schemaObject.properties[`${propertyPath}[${index}]`] = item;</font>
--------------------------------------------------------------------------------
<font color="#26A269">87</font>:      <font color="#5E5C64">map[propertyPath] = property;</font>

<font color="#26A269">lib/dataContract/validation/validateDataContractMaxDepthFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via i</font>
<font color="#26A269">18</font>:    <font color="#5E5C64">const key = keys[i];</font>

<font color="#26A269">lib/document/stateTransition/DocumentsBatchTransition/applyDocumentsBatchTransitionFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via documentTransition.getId()</font>
<font color="#26A269">81</font>:          <font color="#5E5C64">const document = fetchedDocumentsById[documentTransition.getId()];</font>

<font color="#26A269">lib/document/stateTransition/DocumentsBatchTransition/validation/basic/validateDocumentsBatchTransitionBasicFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via rawDocumentTransition.$action</font>
<font color="#26A269">121</font>:          <font color="#5E5C64">const enrichedDataContract = enrichedDataContractsByActions[rawDocumentTransition.$action];</font>

<font color="#26A269">lib/document/stateTransition/DocumentsBatchTransition/validation/state/fetchDocumentsFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.prototype-pollution.prototype-pollution-function.prototype-pollution-function: Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</font>
<font color="#26A269">20</font>:        <font color="#5E5C64">obj[uniqueKey] = [];</font>

<font color="#26A269">lib/identity/stateTransition/IdentityCreateTransition/validation/basic/validateIdentityCreateTransitionBasicFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via rawStateTransition.assetLockProof.type</font>
<font color="#26A269">51</font>:    <font color="#5E5C64">const proofValidationFunction = proofValidationFunctionsByType[</font>
<font color="#26A269">52</font>:<font color="#5E5C64">      rawStateTransition.assetLockProof.type</font>
<font color="#26A269">53</font>:<font color="#5E5C64">    ];</font>

<font color="#26A269">lib/identity/stateTransition/IdentityTopUpTransition/validation/basic/validateIdentityTopUpTransitionBasicFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via rawStateTransition.assetLockProof.type</font>
<font color="#26A269">40</font>:    <font color="#5E5C64">const proofValidationFunction = proofValidationFunctionsByType[</font>
<font color="#26A269">41</font>:<font color="#5E5C64">      rawStateTransition.assetLockProof.type</font>
<font color="#26A269">42</font>:<font color="#5E5C64">    ];</font>

<font color="#26A269">lib/identity/stateTransition/assetLockProof/validateAssetLockTransactionFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via outputIndex</font>
<font color="#26A269">43</font>:    <font color="#5E5C64">const output = transaction.outputs[outputIndex];</font>

<font color="#26A269">lib/stateTransition/validation/validateStateTransitionBasicFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via rawStateTransition.type</font>
<font color="#26A269">40</font>:    <font color="#5E5C64">const validationFunction = validationFunctionsByType[rawStateTransition.type];</font>

<font color="#26A269">lib/stateTransition/validation/validateStateTransitionStateFactory.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.detect-bracket-object-injection.detect-bracket-object-injection: Object injection via bracket notation via stateTransition.getType()</font>
<font color="#26A269">14</font>:    <font color="#5E5C64">const validationFunction = validationFunctions[stateTransition.getType()];</font>

<font color="#26A269">lib/test/utils/generateDeepJson.js</font>
<font color="#A2734C">severity:warning rule:javascript.lang.security.audit.prototype-pollution.prototype-pollution-function.prototype-pollution-function: Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.</font>
<font color="#26A269">15</font>:  <font color="#5E5C64">result[depth] = generateDeepJson(depth - 1);</font>
</pre>
